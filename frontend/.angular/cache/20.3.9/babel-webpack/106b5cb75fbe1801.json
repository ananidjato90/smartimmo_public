{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { PropertyCardComponent } from '../../components/property-card/property-card.component';\nimport { SearchFiltersComponent } from '../../components/search-filters/search-filters.component';\nimport { AiAssistantPanelComponent } from '../../components/ai-assistant-panel/ai-assistant-panel.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/ai-agent.service\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/common\";\nfunction HomePageComponent_div_20_app_property_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-property-card\", 18);\n    i0.ɵɵlistener(\"favoriteToggle\", function HomePageComponent_div_20_app_property_card_1_Template_app_property_card_favoriteToggle_0_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.toggleFavorite($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const property_r4 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"property\", property_r4)(\"isFavorite\", ctx_r2.favorites.has(property_r4.id));\n  }\n}\nfunction HomePageComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, HomePageComponent_div_20_app_property_card_1_Template, 1, 2, \"app-property-card\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.properties);\n  }\n}\nfunction HomePageComponent_ng_template_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"div\", 20);\n    i0.ɵɵtext(2, \"\\uD83D\\uDD0D\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h3\");\n    i0.ɵɵtext(4, \"Aucune propri\\u00E9t\\u00E9 trouv\\u00E9e\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6, \"Essayez de modifier vos crit\\u00E8res de recherche\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let HomePageComponent = /*#__PURE__*/(() => {\n  class HomePageComponent {\n    constructor(api, ai, snackBar) {\n      this.api = api;\n      this.ai = ai;\n      this.snackBar = snackBar;\n      this.properties = [];\n      this.filters = {};\n      this.favorites = new Set();\n      this.loadProperties();\n      this.loadFavorites();\n    }\n    loadProperties() {\n      this.api.getProperties(this.filters).subscribe({\n        next: properties => {\n          this.properties = properties;\n        },\n        error: () => {\n          this.snackBar.open('Impossible de charger les propriétés', 'Fermer', {\n            duration: 3000\n          });\n        }\n      });\n    }\n    loadFavorites() {\n      this.api.listFavorites().subscribe({\n        next: favorites => {\n          this.favorites = new Set(favorites.map(fav => fav.property.id));\n        },\n        error: () => {\n          this.favorites.clear();\n        }\n      });\n    }\n    onFiltersChange(filters) {\n      this.filters = filters;\n      this.loadProperties();\n    }\n    toggleFavorite(property) {\n      const isFavorite = this.favorites.has(property.id);\n      if (isFavorite) {\n        this.api.removeFavorite(property.id).subscribe({\n          next: () => {\n            this.favorites.delete(property.id);\n            this.snackBar.open('Retiré des favoris', undefined, {\n              duration: 2000\n            });\n          },\n          error: () => {\n            this.snackBar.open('Action indisponible. Vérifiez votre session.', 'Fermer', {\n              duration: 3000\n            });\n          }\n        });\n      } else {\n        this.api.addFavorite(property.id).subscribe({\n          next: () => {\n            this.favorites.add(property.id);\n            this.snackBar.open('Ajouté aux favoris', undefined, {\n              duration: 2000\n            });\n          },\n          error: () => {\n            this.snackBar.open('Action indisponible. Vérifiez votre session.', 'Fermer', {\n              duration: 3000\n            });\n          }\n        });\n      }\n    }\n    handleAgentQuery(component, prompt) {\n      component.setLoading(true);\n      this.ai.ask(prompt).subscribe({\n        next: res => component.setResponse(res.response),\n        error: () => {\n          component.setResponse(\"L'assistant est indisponible pour le moment.\");\n          this.snackBar.open(\"Erreur lors de la consultation de l'assistant\", 'Fermer', {\n            duration: 3000\n          });\n        }\n      });\n    }\n    static {\n      this.ɵfac = function HomePageComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || HomePageComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.AiAgentService), i0.ɵɵdirectiveInject(i3.MatSnackBar));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: HomePageComponent,\n        selectors: [[\"app-home-page\"]],\n        decls: 26,\n        vars: 3,\n        consts: [[\"noProperties\", \"\"], [\"assistant\", \"\"], [1, \"home-container\"], [1, \"header\"], [1, \"header-content\"], [1, \"logo\"], [1, \"nav\"], [\"href\", \"#\", 1, \"nav-link\"], [1, \"main-content\"], [1, \"filters-section\"], [3, \"filterChange\", \"initialFilters\"], [1, \"properties-section\"], [1, \"section-title\"], [\"class\", \"properties-grid\", 4, \"ngIf\", \"ngIfElse\"], [1, \"assistant-panel\"], [3, \"querySubmitted\"], [1, \"properties-grid\"], [3, \"property\", \"isFavorite\", \"favoriteToggle\", 4, \"ngFor\", \"ngForOf\"], [3, \"favoriteToggle\", \"property\", \"isFavorite\"], [1, \"no-results\"], [1, \"no-results-icon\"]],\n        template: function HomePageComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ɵɵgetCurrentView();\n            i0.ɵɵelementStart(0, \"div\", 2)(1, \"header\", 3)(2, \"div\", 4)(3, \"h1\", 5);\n            i0.ɵɵtext(4, \"\\uD83C\\uDFE0 SmartImmo\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"nav\", 6)(6, \"a\", 7);\n            i0.ɵɵtext(7, \"Accueil\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"a\", 7);\n            i0.ɵɵtext(9, \"Propri\\u00E9t\\u00E9s\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"a\", 7);\n            i0.ɵɵtext(11, \"Favoris\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"a\", 7);\n            i0.ɵɵtext(13, \"Contact\");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(14, \"main\", 8)(15, \"section\", 9)(16, \"app-search-filters\", 10);\n            i0.ɵɵlistener(\"filterChange\", function HomePageComponent_Template_app_search_filters_filterChange_16_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.onFiltersChange($event));\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(17, \"section\", 11)(18, \"h2\", 12);\n            i0.ɵɵtext(19, \"Propri\\u00E9t\\u00E9s disponibles\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(20, HomePageComponent_div_20_Template, 2, 1, \"div\", 13)(21, HomePageComponent_ng_template_21_Template, 7, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"aside\", 14)(24, \"app-ai-assistant-panel\", 15, 1);\n            i0.ɵɵlistener(\"querySubmitted\", function HomePageComponent_Template_app_ai_assistant_panel_querySubmitted_24_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              const assistant_r5 = i0.ɵɵreference(25);\n              return i0.ɵɵresetView(ctx.handleAgentQuery(assistant_r5, $event));\n            });\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            const noProperties_r6 = i0.ɵɵreference(22);\n            i0.ɵɵadvance(16);\n            i0.ɵɵproperty(\"initialFilters\", ctx.filters);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngIf\", ctx.properties.length > 0)(\"ngIfElse\", noProperties_r6);\n          }\n        },\n        dependencies: [CommonModule, i4.NgForOf, i4.NgIf, MatSnackBarModule, PropertyCardComponent, SearchFiltersComponent, AiAssistantPanelComponent],\n        styles: [\".home-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);box-shadow:0 2px 8px #0000001a;position:sticky;top:0;z-index:100}.header-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center}.logo[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#fff;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.2)}.nav[_ngcontent-%COMP%]{display:flex;gap:2rem}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-weight:500;transition:opacity .3s}.nav-link[_ngcontent-%COMP%]:hover{opacity:.8}.main-content[_ngcontent-%COMP%]{flex:1;max-width:1400px;margin:0 auto;padding:2rem;width:100%;display:grid;grid-template-columns:1fr 380px;gap:2rem}@media (max-width: 1200px){.main-content[_ngcontent-%COMP%]{grid-template-columns:1fr}}.filters-section[_ngcontent-%COMP%]{grid-column:1/-1;background:#fff;border-radius:12px;padding:2rem;box-shadow:0 2px 8px #00000014}.properties-section[_ngcontent-%COMP%]{grid-column:1/2}@media (max-width: 1200px){.properties-section[_ngcontent-%COMP%]{grid-column:1/-1}}.section-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#1e293b;margin:0 0 1.5rem}.properties-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem}.no-results[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;background:#fff;border-radius:12px;box-shadow:0 2px 8px #00000014}.no-results-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;opacity:.5}.no-results[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#475569;margin:0 0 .5rem}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8;margin:0}.assistant-panel[_ngcontent-%COMP%]{grid-column:2/3;position:sticky;top:100px;height:fit-content}@media (max-width: 1200px){.assistant-panel[_ngcontent-%COMP%]{grid-column:1/-1;position:relative;top:0}}\"]\n      });\n    }\n  }\n  return HomePageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}